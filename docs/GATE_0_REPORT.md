# Gate 0 Report: Data Sanity Check

**Date**: 2026-01-02
**Status**: ✅ **PASS** — All 9 symbols validated

---

## Executive Summary

Gate 0 validates the data quality in `data/stage1_raw/` before DQN training begins.

| Check | Status | Details |
|-------|--------|---------|
| **Split Verification** | ✅ PASS | GOOGL, AMZN, TSLA all properly adjusted |
| **Missing Bars Audit** | ✅ PASS | 9/9 symbols at ≥99% coverage |

---

## 1. Split Verification Results

All stock splits in our universe are properly adjusted:

| Symbol | Split | Date | Pre-Split | Post-Split | Change | Status |
|--------|-------|------|-----------|------------|--------|--------|
| GOOGL | 20:1 | 2022-07-15 | $110.37 | $112.33 | 1.8% | ✅ PASS |
| AMZN | 20:1 | 2022-06-06 | $122.35 | $125.57 | 2.6% | ✅ PASS |
| TSLA | 3:1 | 2022-08-25 | $297.15 | $302.38 | 1.8% | ✅ PASS |

All prices are split-adjusted (no 20× or 3× discontinuities detected).

---

## 2. Missing Bars Audit Results

### Summary Table

| Symbol | Date Range | Day Coverage | Bar Coverage | Status |
|--------|------------|--------------|--------------|--------|
| AAPL | 2021-12-20 → 2025-12-19 | 100.0% | 99.82% | ✅ PASS |
| AMZN | 2021-12-20 → 2025-12-19 | 100.0% | 99.77% | ✅ PASS |
| GOOGL | 2021-12-20 → 2025-12-19 | 100.0% | 99.20% | ✅ PASS |
| META | 2021-12-21 → 2025-12-16 | 100.0% | 99.79% | ✅ PASS |
| MSFT | 2021-12-20 → 2025-12-19 | 100.0% | 99.82% | ✅ PASS |
| NVDA | 2021-12-20 → 2025-12-19 | 100.0% | 99.82% | ✅ PASS |
| QQQ | 2021-12-20 → 2025-12-19 | 100.0% | 99.82% | ✅ PASS |
| SPY | 2021-12-21 → 2025-12-16 | 100.0% | 99.82% | ✅ PASS |
| TSLA | 2021-12-21 → 2025-12-16 | 100.0% | 99.82% | ✅ PASS |

### META Backfill Completed

META was initially at 90.9% coverage (FB-era days missing prior to the ticker rename).

**Root Cause**: Ticker change from FB to META on 2022-06-09. The original data fetch used "META" for all dates, missing pre-change data.

**Resolution**:
- `backfill_rth.py` uses **FB** for dates before 2022-06-09 and writes the bars under `META`.
- Holiday calendar updated to include the special market closure on `2025-01-09` (so it is not counted as a "missing day").
- Result: META now shows 100% day coverage and passes Gate 0.

---

## 3. Data Quality Metrics

### Pass Thresholds

| Metric | Threshold | All Symbols |
|--------|-----------|-------------|
| Day coverage | ≥99% | ✅ 100.0% |
| Bar coverage | ≥98% | ✅ 99.2-99.8% |
| NaN values | 0 | ✅ 0 |
| Split adjustment | <15% change | ✅ <3% |

### Minor Issues (Non-Blocking)

- **GOOGL**: 109 incomplete days, 2104 intraday gaps (low-volume periods)
- **AMZN**: 11 incomplete days, 168 intraday gaps

These are within tolerance and do not block training.

---

## 4. Scripts Created

| Script | Purpose |
|--------|---------|
| `scripts/dqn/verify_splits.py` | Verify stock split adjustments |
| `scripts/dqn/audit_missing_bars.py` | Audit missing bars and data quality |
| `scripts/dqn/backfill_rth.py` | Backfill missing RTH data from Polygon |

### Backfill Script Features

- Handles ticker changes (FB → META)
- Rate limiting with retry on 429
- Saves to existing parquet files
- Dry-run mode for preview

---

## 5. Gate 0 Decision

| Verdict | Status |
|---------|--------|
| ✅ **PASS** | All 9 symbols validated |

**Gate 0 Complete**: Ready to proceed to Gate 1 (train/val/test split creation).

---

## Changelog

| Date | Action |
|------|--------|
| 2026-01-02 | Initial audit: 8/9 pass, META at 90.9% |
| 2026-01-02 | Added FB→META ticker change handling |
| 2026-01-02 | Backfilled 90 days for META |
| 2026-01-02 | Final audit: 9/9 PASS |

---

*Report generated by Gate 0 validation pipeline*
